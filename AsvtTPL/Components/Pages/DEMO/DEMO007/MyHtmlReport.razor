@using Vista.Component.Models

<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <style>
    /* A4 size: 297mm x 210mm - 用於進階控制分頁，一般不需要。
    .page {
      position: relative;
      width: 190mm;
      height: 277mm;
      display: block;
      box-sizing: border-box;
      margin-left: auto;
      margin-right: auto;
      font-size: 14px;
      font-family: '微軟正黑體', 'Microsoft JhengHei','Microsoft YaHei', sans-serif;
    } */

    @@page {
      size: A4 portrait; /* 直印 */     
      margin-top: 20mm;
      margin-left: 10mm;
      margin-right: 10mm;
      margin-bottom: 10mm;
    }

    * {
      font-family: '微軟正黑體', 'Microsoft JhengHei','Microsoft YaHei', sans-serif;
    }

    body {
      box-sizing: border-box;
      font-size: 14px;
    }

      /* 可在開發時在 browser 預算寬度。但無法預算高度。 */
      body.dev-preview {
        @@media screen {
          margin-left: auto;
          margin-right: auto;
          width: 190mm;
          outline: dashed pink 1px;
        }
      }

    .break-page {
      page-break-before: always;
    }

    /* 浮水印 */
    .watermark {
      background-image: url("@(WatermarkImageUrl)");
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    td, th {
      border: 1px solid #dddddd;
      text-align: left;
      padding: 8px;
    }

    tr:nth-child(even) {
      background-color: #eeeeee; /* 預設：加入條紋 */
    }

    /* 無邊界線表格 */
    table.noborder {
      border-collapse: collapse;
      width: 100%;
    }

      table.noborder td,
      table.noborder th {
        border: initial; /* 移除邊界線  */
        text-align: left;
        padding: initial; /* 移除 padding */
      }

      table.noborder tr:nth-child(even) {
        background-color: initial; /* 移除條紋 */
      }

    /* 複雜一些的表格 */
    table.table2 tr:nth-child(even) {
      background-color: initial; /* 移除條紋 */
    }

    /* =================== */
    .big-font {
      color: blue;
      font-size: 20mm;
    }

    .box {
      border: dashed 2px red;
      padding: 2mm;
    }


    .barcode-sticker {
      display: inline-block;
      padding: 0 2mm;
      margin: 2mm;
      border: solid 2px darkgrey;
      border-radius: 2mm;
    }

      .barcode-sticker > img {
        display: inline-block;
        line-height: 0;
        vertical-align: middle;
        margin: 1px 0;
      }

      .barcode-sticker > div.label {
        display: inline-block;
        vertical-align: middle;
        color: #8D1485;
        font-weight: 600;
      }

    .signature {
      text-align: center;
      width: calc(100% - 8mm);
      margin: 4mm 4mm 0 4mm;
      border: 1pt solid #000;
      border-radius: 4mm;
    }
  </style>
</head>
<body class="dev-preview watermark">

  <h1>HTML轉PDF測試：銀行簡介</h1>
  <div class="big-font" style="font-family:標楷體">@Title</div>
  <p>WatermarkImageUrl: @WatermarkImageUrl</p>

  <p>&emsp;&emsp;本行前身為歷史悠久的「台北三信」，創立於民國7年4月，原名「艋舺信用組合」，於民國35年7月艋舺信用組合奉令重新改組，更名為「台北市艋舺信用合作社」。而後因改制關係，台北市艋舺信用合作社於民國36年更名為「有限責任台北市第三信用合作社」。民國55年6月再度因制度更改，變更有限責任組織為保證責任組織，並更名為「保證責任台北市第三信用合作社」，即改制銀行前的「台北三信」。</p>
  <p>&emsp;&emsp;70年代後期，國內金融環境開始產生顯著的變動，受利率自由化之影響，銀行的業務範圍及營業據點逐漸擴充，進而衝擊到原先信用合作社的市場。財政部於民國84年11月公佈「信合社改制銀行辦法」，本行即著手進行申請改制作業，於民國86年1月改制成為「誠泰商業銀行」，其後為配合政府政策，協助解決金融問題，並為擴大營運規模，分別於民國86年及87年概括承受新竹二信與台中八信，同時受惠於銀行法一年可申設五家分行之規定，將營業區域擴大至台北、桃園、新竹等地區；90年9月初概括承受嘉義二信後，旋即在行政院金融重建基金機制運作下，於月中概括承受岡山信用合作社，迅速擴大服務範圍，一舉將業務拓展至全台灣，分行家數達到80家。</p>
  <hr style='margin-top:2mm;margin-bottom:2mm;' />
  <img src='https://www.w3schools.com/html/pic_trulli.jpg' width='500' height='333'>
  <hr style='margin-top:2mm;margin-bottom:2mm;' />

  <table>
    <thead>
      <tr>
        <th>Company</th>
        <th>Contact</th>
        <th>Country</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Centro comercial Moctezuma</td><td>Francisco Chang</td><td>Mexico</td></tr>
      <tr><td>Ernst Handel</td><td>Roland Mendel</td><td>Austria</td></tr>
      <tr><td>Island Trading</td><td>Helen Bennett</td><td>UK</td></tr>
      <tr><td>Laughing Bacchus Winecellars</td><td>Yoshi Tannamuri</td><td>Canada</td></tr>
      <tr><td>Magazzini Alimentari Riuniti</td><td>Giovanni Rovelli</td><td>Italy</td></tr>
      <tr><td>Centro comercial Moctezuma</td><td>Francisco Chang</td><td>Mexico</td></tr>
      <tr><td>Ernst Handel</td><td>Roland Mendel</td><td>Austria</td></tr>
      <tr><td>Island Trading</td><td>Helen Bennett</td><td>UK</td></tr>
      <tr><td>Laughing Bacchus Winecellars</td><td>Yoshi Tannamuri</td><td>Canada</td></tr>
      <tr><td>Magazzini Alimentari Riuniti</td><td>Giovanni Rovelli</td><td>Italy</td></tr>
      <tr><td>Centro comercial Moctezuma</td><td>Francisco Chang</td><td>Mexico</td></tr>
      <tr><td>Ernst Handel</td><td>Roland Mendel</td><td>Austria</td></tr>
      <tr><td>Island Trading</td><td>Helen Bennett</td><td>UK</td></tr>
      <tr><td>Laughing Bacchus Winecellars</td><td>Yoshi Tannamuri</td><td>Canada</td></tr>
      <tr><td>Magazzini Alimentari Riuniti</td><td>Giovanni Rovelli</td><td>Italy</td></tr>
      <tr><td>Centro comercial Moctezuma</td><td>Francisco Chang</td><td>Mexico</td></tr>
      <tr><td>Ernst Handel</td><td>Roland Mendel</td><td>Austria</td></tr>
      <tr><td>Island Trading</td><td>Helen Bennett</td><td>UK</td></tr>
      <tr><td>Laughing Bacchus Winecellars</td><td>Yoshi Tannamuri</td><td>Canada</td></tr>
      <tr><td>Magazzini Alimentari Riuniti</td><td>Giovanni Rovelli</td><td>Italy</td></tr>
      <tr><td>Centro comercial Moctezuma</td><td>Francisco Chang</td><td>Mexico</td></tr>
      <tr><td>Ernst Handel</td><td>Roland Mendel</td><td>Austria</td></tr>
      <tr><td>Island Trading</td><td>Helen Bennett</td><td>UK</td></tr>
      <tr><td>Laughing Bacchus Winecellars</td><td>Yoshi Tannamuri</td><td>Canada</td></tr>
      <tr><td>Magazzini Alimentari Riuniti</td><td>Giovanni Rovelli</td><td>Italy</td></tr>
    </tbody>
    <tfoot>
      <tr>
        <td colspan="3">Footer</td>
      </tr>
    </tfoot>
  </table>

  <h1 class="break-page">複雜一些的表格 H1<small style="color:darkorange;">(強制分頁控制)</small></h1>
  <h2>複雜一些的表格 H2</h2>
  <h3>複雜一些的表格 H3</h3>
  <h4>複雜一些的表格 H4</h4>
  <h5>複雜一些的表格 H5</h5>
  <h6>複雜一些的表格 H6</h6>

  <table class="noborder">
    <caption>銀行法第三十三條之一「有利害關係都」資料表</caption>
    <tr>
      <td>姓名: 徐X東</td>
      <td>職稱: 經理</td>
      <td>身分證統一編號: A123456789</td>
      <td>基準日: 2024/09/06</td>
    </tr>
  </table>

  <table class="table2">
    <tr>
      <th colspan="4">有關親屬資料</th>
      <th colspan="5">有關事業資料</th>
      <th rowspan="2">備註</th>
    </tr>
    <tr>
      <th>親等</th>
      <th>稱謂</th>
      <th>姓名</th>
      <th>身份證/護照號碼</th>
      <th>名稱</th>
      <th>營利事業編號</th>
      <th>職稱</th>
      <th>持股比例</th>
      <th>是否為「經理人」</th>
    </tr>
    <tr>
      <th>本人</th>
      <th>本人</th>
      <td>徐X東</td>
      <td>A123456789</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>配偶</th>
      <th>妻</th>
      <td>ＹＹＹ</td>
      <td>B123456789</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3">三親等以內血親</th>
      <th>父</th>
      <td>徐ＺＺ</td>
      <td>C123456789</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>母</th>
      <td>徐母ＺＺ</td>
      <td>D123456789</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>兄</th>
      <td>徐ＡＢ</td>
      <td>E123456789</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="4">二親等以內姻親</th>
      <th>配偶之父</th>
      <td>Ｙ妻父</td>
      <td>X123456789</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>配偶之母</th>
      <td>Ｙ妻母</td>
      <td>X123456789</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>配偶之兄</th>
      <td>Ｙ妻兄</td>
      <td>X123456789</td>
      <td>小小實業</td>
      <td>12345678</td>
      <td>經理</td>
      <td>8.00%</td>
      <td>是</td>
      <td></td>
    </tr>
    <tr>
      <th>配偶之弟</th>
      <td>Ｙ妻弟</td>
      <td>X123456789</td>
      <td>喵喵商行</td>
      <td>12345678</td>
      <td>店長</td>
      <td>100.00%</td>
      <td>是</td>
      <td></td>
    </tr>
  </table>
  <table class="noborder">
    <tr>
      <td colspan="2">
        填表說明：銀行負責人及有權核定授信案件之職員，均須填本表，缷任現職者之資料，至少應保留三年，並於備註欄註明卸任日期。
      </td>
    </tr>
    <tr>
      <td>填表人： 徐X東</td>
      <td style="text-align:right;">(填表時已打勾確認資料為正確)</td>
    </tr>
  </table>

  <h1 class="break-page">顯示清單 <small style="color:darkorange;">(強制分頁控制)</small></h1>
  <ol>
    @foreach (var item in ItemList)
    {
      <li>@($"{item.ImageFileName} {item.ImageType}")</li>
    }
  </ol>

  <h1 class="h3">@($"筆記型電腦({BarcodeList.Count}筆)")</h1>

  @foreach (var (value, barcodeB64) in BarcodeList)
  {
    <div class="barcode-sticker">
      <img alt="@value" src="@barcodeB64">
      <div class="label">
        <div>亞洲志遠</div>
        <div>@value</div>
      </div>
    </div>
  }

  <h1>小表格</h1>
  <table style="width:60%;margin-left:20%;">
    <tr>
      <th>Company</th>
      <th>Contact</th>
      <th>Country</th>
    </tr>
    <tr><td>Centro comercial Moctezuma</td><td>Francisco Chang</td><td>Mexico</td></tr>
    <tr><td>Ernst Handel</td><td>Roland Mendel</td><td>Austria</td></tr>
    <tr><td>Island Trading</td><td>Helen Bennett</td><td>UK</td></tr>
    <tr><td>Laughing Bacchus Winecellars</td><td>Yoshi Tannamuri</td><td>Canada</td></tr>
    <tr><td>Magazzini Alimentari Riuniti</td><td>Giovanni Rovelli</td><td>Italy</td></tr>
  </table>

  @* 簽名區若要在頁面底部，已知最簡單解法：依資料筆數推算要留白多少。 *@
  @foreach (var i in Enumerable.Range(0, 7))
  {
    <div style="1rem">&nbsp;</div>
  }

  <p style="color:red;">※ 簽名區若要在頁面底部，已知最簡單解法：依資料筆數推算要留白多少。</p>
  <div class="signature">
    <p>&nbsp;</p>
    <p>&nbsp;</p>
    <p>簽名：________________________________________________</p>
    <p>日期：________________________________________________</p>
  </div>



</body>
</html>

@code {
  [Parameter] public string Title { get; set; } = "這是報表標題";
  [Parameter] public List<ImageCropInfo> ItemList { get; set; } = new();
  [Parameter] public List<(string, string)> BarcodeList { get; set; } = new();
  [Parameter] public string WatermarkImageUrl { get; set; } = default!;
}
