@using Vista.Biz.DEMO

@if (ItemAim == null)
{
  <MudText Typo=Typo.h6>請選擇一個項目</MudText>
  return;
}

<MudPaper role="panel">
  <MudToolBar Dense Gutters=false>
    <MudText Typo=Typo.h6>編輯屬性</MudText>
    <MudSwitch Color=Color.Warning Value=EnableRemove ValueChanged=EnableRemoveChanged Label="啟動移除" />
    <MudSpacer />
    <MudIconButton Icon=@Icons.Material.Filled.Close OnClick="()=>OnClose.InvokeAsync()" />
  </MudToolBar>

  <EditForm Model=ItemAim>
    <FluentValidationValidator />

    <AsvtFormRow Grid=@([12])>
      <AsvtStaticField For="()=>ItemAim.Order" Label="項目編號">
        @($"{ItemAim.L1Num}.{ItemAim.L2Num}")
      </AsvtStaticField>

      @* for debug *@
      <AsvtStaticField For="()=>ItemAim.Order" Label="Order/Level/IsGroup">
        @($"{ItemAim.Order}/{ItemAim.Level}/{ItemAim.IsGroup}")
      </AsvtStaticField>
    </AsvtFormRow>

    <AsvtFormRow Grid=@([6])>
      <AsvtTextAreaField For="()=>ItemAim.Description" Grid=@([12]) />
      <AsvtNumberField For="()=>ItemAim.UnitPrice" />
      <AsvtNumberField For="()=>ItemAim.Quantity" />
      <AsvtNumberField For="()=>ItemAim.ExtendedPrice" ReadOnly=true />
    </AsvtFormRow>

    <MudStack Row Justify=Justify.Center Class="my-3">
      <MudButton Variant=Variant.Filled Color=Color.Primary>更新</MudButton>
      <MudButton Variant=Variant.Filled Color=Color.Warning Disabled=@(!EnableRemove)>移除</MudButton>
    </MudStack>

    <DialogValidationSummary />
  </EditForm>
</MudPaper>

@code {
  [Parameter] public DropItem? ItemAim { get; set; }
  [Parameter] public EventCallback OnClose { get; set; }
  [Parameter] public bool EnableRemove { get; set; }
  [Parameter] public EventCallback<bool> EnableRemoveChanged { get; set; }

  //## State
  bool f_remove = false;

}
